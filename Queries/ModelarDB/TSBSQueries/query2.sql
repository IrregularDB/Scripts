select max(value), bucketNumber from (select value, DATEDIFF(ms, '1970-01-01 00:00:00', timestamp)/300000 as bucketNumber from datapoint where timestamp >=  DATEADD('MILLISECOND', 1451606400000, DATE '1970-01-01') and timestamp <= DATEADD('MILLISECOND', 1451649600000, DATE '1970-01-01') and (tid = 297 OR tid = 212 OR tid = 196 OR tid = 111 OR tid = 95)) group by bucketNumber;
select max(value), bucketNumber from (select value, DATEDIFF(ms, '1970-01-01 00:00:00', timestamp)/300000 as bucketNumber from datapoint where timestamp >=  DATEADD('MILLISECOND', 1451606400000, DATE '1970-01-01') and timestamp <= DATEADD('MILLISECOND', 1451649600000, DATE '1970-01-01') and (tid = 297 OR tid = 212 OR tid = 196 OR tid = 111 OR tid = 95)) group by bucketNumber;
select max(value), bucketNumber from (select value, DATEDIFF(ms, '1970-01-01 00:00:00', timestamp)/300000 as bucketNumber from datapoint where timestamp >=  DATEADD('MILLISECOND', 1451606400000, DATE '1970-01-01') and timestamp <= DATEADD('MILLISECOND', 1451649600000, DATE '1970-01-01') and (tid = 297 OR tid = 212 OR tid = 196 OR tid = 111 OR tid = 95)) group by bucketNumber;
select max(value), bucketNumber from (select value, DATEDIFF(ms, '1970-01-01 00:00:00', timestamp)/300000 as bucketNumber from datapoint where timestamp >=  DATEADD('MILLISECOND', 1451606400000, DATE '1970-01-01') and timestamp <= DATEADD('MILLISECOND', 1451649600000, DATE '1970-01-01') and (tid = 297 OR tid = 212 OR tid = 196 OR tid = 111 OR tid = 95)) group by bucketNumber;
select max(value), bucketNumber from (select value, DATEDIFF(ms, '1970-01-01 00:00:00', timestamp)/300000 as bucketNumber from datapoint where timestamp >=  DATEADD('MILLISECOND', 1451606400000, DATE '1970-01-01') and timestamp <= DATEADD('MILLISECOND', 1451649600000, DATE '1970-01-01') and (tid = 297 OR tid = 212 OR tid = 196 OR tid = 111 OR tid = 95)) group by bucketNumber;

